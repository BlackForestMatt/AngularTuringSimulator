var Lexer=function(){function t(t){this.terminalAlphabet=t.slice(0),this.terminalAlphabet.sort(function(t,e){return e.length-t.length}),this.tokens=[],this.source="",this.len=0,this.pos=0}return t.prototype.inBounds=function(){return this.pos<this.len},t.prototype.getChar=function(){return this.source.charAt(this.pos)},t.prototype.isNewline=function(t){return"\r"===t||"\n"===t},t.prototype.isSpace=function(t){return" "===t||"\t"===t},t.prototype.isAplhaNumeric=function(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"||t>="0"&&t<="9"},t.prototype.alphabetIndex=function(){var t,e,s,i,n=-1;for(i=0;i<this.terminalAlphabet.length;i++){var r=this.terminalAlphabet[i];for(t=this.pos,e=0,s=!0;s&&e<r.length&&t<this.source.length;)s=s&&this.source.charAt(t)===r.charAt(e),t++,e++;if(s&&t-this.pos===r.length)return i}return n},t.prototype.skipWhiteSpaces=function(){for(var t=this.getChar();this.inBounds()&&(this.isSpace(t)||this.isNewline(t));)this.pos++,t=this.getChar()},t.prototype.parseComment=function(){for(var t=this.getChar();this.inBounds()&&!this.isNewline(t);)this.pos++,t=this.getChar()},t.prototype.parseIdentifier=function(){for(var t,e=this.pos,s=this.getChar();this.inBounds()&&(this.isAplhaNumeric(s)||"_"===s);)this.pos++,s=this.getChar();return t={type:"IDENTIFIER",value:this.source.substring(e,this.pos),pos:e}},t.prototype.tokenize=function(t){this.source=t,this.len=t.length,this.pos=0,this.tokens=[];for(var e;this.inBounds();){this.skipWhiteSpaces();var s=this.getChar(),i=this.alphabetIndex();if("/"===s)this.parseComment();else if(i!==-1){var n=this.terminalAlphabet[i];e={type:"TERMINAL",value:this.terminalAlphabet[i],pos:this.pos},this.pos+=n.length,this.tokens.push(e)}else if(this.isAplhaNumeric(s)||"_"===s)this.tokens.push(this.parseIdentifier());else if(""!==s)throw new Error("Unexpected character: "+s)}return e={type:"ENDOFINPUT",value:"$",pos:this.pos},this.tokens.push(e),this.tokens},t}(),ParseStack=function(){function t(){this.stack=[]}return t.prototype.pop=function(){return this.stack.pop()},t.prototype.push=function(t){if("string"==typeof t)this.stack.push(t);else{if("object"!=typeof t||!t.length)throw new Error("Cannont push "+typeof t);t=t.slice(0),this.stack=this.stack.concat(t.reverse())}},t.prototype.head=function(){return this.stack[this.stack.length-1]},t.prototype.isEmpty=function(){return 0===this.stack.length},t}(),ParseTable=function(){function t(){}return t.prototype.getExpansions=function(e){return t.table[e]},t.prototype.get=function(t,e){var s,i=this.getExpansions(t);return i&&(s="IDENTIFIER"===e.type?i.z:i[e.value]),s},t.prototype.isNonTerminal=function(t){return null!==this.getExpansions(t)},t.table={STATEMENT:{start:["ASSIGNMENT",";","STATEMENT"],end:["ASSIGNMENT",";","STATEMENT"],blank:["ASSIGNMENT",";","STATEMENT"],z:["FUNCTION",";","STATEMENT"],$:"eps"},FUNCTION:{z:["z",",","v","->","z",",","v",",","DIRECTION"]},ASSIGNMENT:{start:["start",":=","z"],end:["end",":=","{","z","X2","}"],blank:["blank",":=","v"]},X2:{",":[",","z","X2"],"}":"eps"},DIRECTION:{"<":["<"],">":[">"],"-":["-"]}},t}(),ASTNode=function(){function t(t){this.data=t,this.children=[],this.parent=null}return t.prototype.add=function(e){var s,i;if("string"==typeof e)i=new t(e),i.parent=this,this.children.push(i);else{if(!("object"==typeof e&&e.length>=0))throw new Error("Cannot add "+typeof e+"to AST");for(var n=0;n<e.length;n++)s=new t(e[n]),s.parent=this,this.children.push(s),0===n&&(i=s)}return i},t.prototype.traverse=function(t){!function e(s){for(var i=0;i<s.children.length;i++)e(s.children[i]);t(s)}(this)},t.prototype.print=function(){var t=0;!function e(s){t++,s.children.forEach(function(s,i){console.log(Array(t).join(" ")+"|- "+s.data),e(s)}),t--}(this)},t.prototype.remove=function(t){var e;return this.traverse(function(s){for(var i=0;i<s.children.length;i++)e||s.children[i].data!==t||(s.children.splice(i,1)[0],e=s)}),e},t.prototype.findEmpty=function(t){var e;return this.traverse(function(s){e||s.data!==t||0!==s.children.length||(e=s)}),e},t.prototype.getAll=function(t){var e=[];return this.traverse(function(s){s.data===t&&e.push(s)}),e},t}(),Parser=function(){function t(){this.parseTable=new ParseTable}return t.prototype.parse=function(t){var e;for(this.AST=new ASTNode("BASE"),this.AST.add("STATEMENT"),this.parseStack=new ParseStack,this.parseStack.push(["STATEMENT","$"]),this.pos=0;!this.parseStack.isEmpty();){var s=t[this.pos],i=this.parseStack.head(),n=this.parseTable.get(i,s);if(n)if(this.parseStack.pop(),"eps"!==n){if(e=this.AST.findEmpty(i)){var r=n.slice(0);"STATEMENT"===i?(e.parent.remove("STATEMENT"),e=e.parent,r=[r[0],r[2]]):"ASSIGNMENT"===i?r="end"===r[0]?[r[0],r[3],r[4]]:[r[0],r[2]]:"X2"===i?(e.parent.remove("X2"),e=e.parent,r=[r[1],r[2]]):"FUNCTION"===i?r=[r[0],r[2],r[4],r[6],r[8]]:"DIRECTION"===i&&(e.data=r[0],r=[]),e.add(r),this.parseStack.push(n)}}else this.AST.remove(i);else{if(e=this.AST.findEmpty(i),!(i===s.value||"z"===i&&"IDENTIFIER"===s.type||"v"===i&&"IDENTIFIER"===s.type&&1===s.value.length))throw"z"===i?new SyntaxError("Expected a state but instead saw: '"+s.value+"' at ["+s.pos+"]"):"v"===i?new SyntaxError("Expected a symbol but instead saw: '"+s.value+"' at ["+s.pos+"]"):new SyntaxError("Expected: '"+i+"' but instead saw: '"+s.value+"' at ["+s.pos+"]");e&&(e.data=s.value),this.parseStack.pop(),this.pos++}}return this.AST},t}(),Generator=function(){function t(){this.stateIndex={start:0,blank:1,end:2,alph:3},this.alphIndex={},this.alphPool=0,this.statePool=4,this.TMScode=[]}return t.prototype.getState=function(t){if(!this.stateIndex.hasOwnProperty(t)){var e=this.statePool++;this.stateIndex[t]=e,this.extendRow(2,e+1),this.TMScode.push([])}return this.stateIndex[t]},t.prototype.getAlphShift=function(t){if(!this.alphIndex.hasOwnProperty(t)){var e=this.alphPool;this.alphPool+=3,this.extendRow(3,e+1),this.TMScode[3][e]=t.charCodeAt(0),this.alphIndex[t]=e}return this.alphIndex[t]},t.prototype.getDirection=function(t){return">"===t?1:"<"===t?-1:0},t.prototype.setStart=function(t){var e=this.getState(t);this.TMScode[0]=[e]},t.prototype.setBlank=function(t){var e=this.getAlphShift(t);this.TMScode[1]=[e]},t.prototype.setEnds=function(t){for(var e=0;e<t.length;e++){var s=this.getState(t[e]);this.TMScode[2][s]=1}},t.prototype.extendRow=function(t,e){this.TMScode[t]||(this.TMScode[t]=[]);for(var s=this.TMScode[t].length;s<e;s++)this.TMScode[t].push(0)},t.prototype.addTransition=function(t,e,s,i,n){var r=this.getState(t),o=this.getState(s),a=this.getAlphShift(e),h=this.getAlphShift(i),p=this.getDirection(n);if(r===o&&a===h&&0===p)throw new Error("Transition to self: ("+t+","+e+") -> ("+s+","+i+","+n+")");if(this.extendRow(r,a+3),0!==this.TMScode[r][a])throw new Error("Transition already defined: ("+t+","+e+")");this.TMScode[r][a]=o,this.TMScode[r][a+1]=h,this.TMScode[r][a+2]=p},t.prototype.getStateMap=function(){return this.stateIndex},t.prototype.generate=function(t){this.stateIndex={start:0,blank:1,end:2,alph:3},this.alphIndex={},this.statePool=4,this.alphPool=0,this.TMScode=[],this.TMScode[2]=[];var e=this,s=t.getAll("FUNCTION");s.forEach(function(t,s){var i=t.children;e.addTransition(i[0].data,i[1].data,i[2].data,i[3].data,i[4].data)});var i=t.getAll("ASSIGNMENT");return i.forEach(function(t,s){var i=t.children;if("start"===i[0].data)e.setStart(i[1].data);else if("blank"===i[0].data)e.setBlank(i[1].data);else if("end"===i[0].data){for(var n=[],r=1;r<i.length;r++)n.push(i[r].data);e.setEnds(n)}}),this.TMScode},t}(),Compiler=function(){function t(){this.alphabet=["start","blank","end",":=","->",",",";","{","}","-","<",">"],this.lexer=new Lexer(this.alphabet),this.parser=new Parser,this.generator=new Generator}return t.prototype.getTokens=function(){return this.tokens},t.prototype.getAST=function(){return this.astree},t.prototype.getStateMap=function(){return this.generator.getStateMap()},t.prototype.compile=function(t){return this.tokens=this.lexer.tokenize(t),this.astree=this.parser.parse(this.tokens),this.code=this.generator.generate(this.astree),this.code},t}(),TuringConfiguration=function(){function t(t,e,s,i,n){this.state=t,this.position=e,this.tape=s,this.isEndState=i,this.isDone=n}return t}(),TuringSimulator=function(){function t(t){this.code=t,this.tapePos=1,this.state=this.code[0][0],this.blank=this.code[1][0],this.steps=0}return t.prototype.setWord=function(t){this.tape=[this.blank];for(var e=0;e<t.length;e++){var s=t.charCodeAt(e),i=this.code[3].indexOf(s);this.tape.push(i)}this.tape.push(this.blank)},t.prototype.reset=function(){this.tapePos=1,this.state=this.code[0][0],this.steps=0},t.prototype.getWord=function(){for(var t="",e=0;e<this.tape.length;e++){var s=this.tape[e];s!==this.code[1][0]&&(t+=String.fromCharCode(this.code[3][s]))}return t},t.prototype.getState=function(t){var e=""+t;if(this.stateMap)for(var s in this.stateMap)this.stateMap[s]===t&&(e=s);return e},t.prototype.updateTape=function(){this.tapePos>=this.tape.length?this.tape.push(this.blank):this.tapePos<0&&(this.tape.unshift(this.blank),this.tapePos++)},t.prototype.isEndState=function(t){return 1===this.code[2][t]},t.prototype.setStateMap=function(t){this.stateMap=t},t.prototype.setup=function(t){this.reset(),this.setWord(t)},t.prototype.getSteps=function(){return this.steps},t.prototype.step=function(){var t;if(!this.tape)throw new Error("No input to run simulator on");var e=this.state,s=this.tapePos,i=this.tape[s],n=this.code[e]&&this.code[e][i]&&0===this.code[2][e];return n&&(this.steps++,this.state=this.code[e][i],this.tape[s]=this.code[e][i+1],this.tapePos+=this.code[e][i+2],this.updateTape()),t=new TuringConfiguration(this.getState(e),s,this.getWord(),this.isEndState(e),(!n))},t.prototype.run=function(t){this.setup(t);for(var e=this.step();!e.isDone;)e=this.step();return e},t}();